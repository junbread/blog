<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>이펙티브 자바 6장 정리 | Junbread🥐</title><meta name=keywords content="Study,Java"><meta name=description content="아이템 34: int 상수 대신 열거 타입을 사용하라 Java 1.5 Enum 등장 전 사용되던 int enum 패턴
public static final int APPLE_FUJI = 0; public static final int APPLE_PIPPIN = 1; public static final int APPLE_GRANNY_SMITH = 2; public static final int ORANGE_NAVEL = 0; public static final int ORANGE_TEMPLE = 1; public static final int ORANGE_BLOOD = 2; 타입 안전을 보장할 방법이 없다. 표현 방식이 까다롭다. toString(), 디버거 등에서는 그냥 아무 의미 없는 상수로 보인다."><meta name=author content><link rel=canonical href=https://junbread.win/posts/2021/effective-java-06/><link crossorigin=anonymous href=/assets/css/stylesheet.f6c1b3e9443ffcf8efd37433e13b909fd545f99414f2ac3e5b22795096fc9f44.css integrity="sha256-9sGz6UQ//Pjv03Qz4TuQn9VF+ZQU8qw+WyJ5UJb8n0Q=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://junbread.win/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://junbread.win/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://junbread.win/favicon-32x32.png><link rel=apple-touch-icon href=https://junbread.win/apple-touch-icon.png><link rel=mask-icon href=https://junbread.win/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet type=text/css crossorigin href=//cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/variable/pretendardvariable-dynamic-subset.css><link rel=stylesheet type=text/css crossorigin href="//fonts.googleapis.com/css2?family=Source+Code+Pro"><script async src="https://www.googletagmanager.com/gtag/js?id=G-0QLLXH086F"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0QLLXH086F",{anonymize_ip:!1})}</script><meta property="og:title" content="이펙티브 자바 6장 정리"><meta property="og:description" content="아이템 34: int 상수 대신 열거 타입을 사용하라 Java 1.5 Enum 등장 전 사용되던 int enum 패턴
public static final int APPLE_FUJI = 0; public static final int APPLE_PIPPIN = 1; public static final int APPLE_GRANNY_SMITH = 2; public static final int ORANGE_NAVEL = 0; public static final int ORANGE_TEMPLE = 1; public static final int ORANGE_BLOOD = 2; 타입 안전을 보장할 방법이 없다. 표현 방식이 까다롭다. toString(), 디버거 등에서는 그냥 아무 의미 없는 상수로 보인다."><meta property="og:type" content="article"><meta property="og:url" content="https://junbread.win/posts/2021/effective-java-06/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-15T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="이펙티브 자바 6장 정리"><meta name=twitter:description content="아이템 34: int 상수 대신 열거 타입을 사용하라 Java 1.5 Enum 등장 전 사용되던 int enum 패턴
public static final int APPLE_FUJI = 0; public static final int APPLE_PIPPIN = 1; public static final int APPLE_GRANNY_SMITH = 2; public static final int ORANGE_NAVEL = 0; public static final int ORANGE_TEMPLE = 1; public static final int ORANGE_BLOOD = 2; 타입 안전을 보장할 방법이 없다. 표현 방식이 까다롭다. toString(), 디버거 등에서는 그냥 아무 의미 없는 상수로 보인다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://junbread.win/posts/"},{"@type":"ListItem","position":3,"name":"이펙티브 자바 6장 정리","item":"https://junbread.win/posts/2021/effective-java-06/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"이펙티브 자바 6장 정리","name":"이펙티브 자바 6장 정리","description":"아이템 34: int 상수 대신 열거 타입을 사용하라 Java 1.5 Enum 등장 전 사용되던 int enum 패턴\npublic static final int APPLE_FUJI = 0; public static final int APPLE_PIPPIN = 1; public static final int APPLE_GRANNY_SMITH = 2; public static final int ORANGE_NAVEL = 0; public static final int ORANGE_TEMPLE = 1; public static final int ORANGE_BLOOD = 2; 타입 안전을 보장할 방법이 없다. 표현 방식이 까다롭다. toString(), 디버거 등에서는 그냥 아무 의미 없는 상수로 보인다.","keywords":["Study","Java"],"articleBody":"아이템 34: int 상수 대신 열거 타입을 사용하라 Java 1.5 Enum 등장 전 사용되던 int enum 패턴\npublic static final int APPLE_FUJI = 0; public static final int APPLE_PIPPIN = 1; public static final int APPLE_GRANNY_SMITH = 2; public static final int ORANGE_NAVEL = 0; public static final int ORANGE_TEMPLE = 1; public static final int ORANGE_BLOOD = 2; 타입 안전을 보장할 방법이 없다. 표현 방식이 까다롭다. toString(), 디버거 등에서는 그냥 아무 의미 없는 상수로 보인다. 그렇다고 문자열 상수를 사용하자니, 성능 저하 + 문자열 하드코딩의 위험이 있다. → Enum 타입을 사용하자.\npublic enum Apple { FUJI, PIPPIN, GRANNY_SMITH } public enum Orange { NAVEL, TEMPLE, BLOOD } Enum 타입의 장점 Java의 Enum은 완전한 클래스이다. 밖에서 접근 가능한 생성자가 없기 때문에, 사실상 final이다. 따라서 오직 하나만 존재함이 보장된다. 컴파일타임 타입 안전성을 제공한다. 출력하기에 적합한 문자열을 제공한다. 상수별 메서드 구현 // 코드 34-6 상수별 클래스 몸체(class body)와 데이터를 사용한 열거 타입 (215-216쪽) public enum Operation { PLUS(\"+\") { public double apply(double x, double y) { return x + y; } }, MINUS(\"-\") { public double apply(double x, double y) { return x - y; } }, TIMES(\"*\") { public double apply(double x, double y) { return x * y; } }, DIVIDE(\"/\") { public double apply(double x, double y) { return x / y; } }; private final String symbol; Operation(String symbol) { this.symbol = symbol; } @Override public String toString() { return symbol; } public abstract double apply(double x, double y); // 코드 34-7 열거 타입용 fromString 메서드 구현하기 (216쪽) private static final Map\u003cString, Operation\u003e stringToEnum = Stream.of(values()).collect( toMap(Object::toString, e -\u003e e)); // 지정한 문자열에 해당하는 Operation을 (존재한다면) 반환한다. public static Optional\u003cOperation\u003e fromString(String symbol) { return Optional.ofNullable(stringToEnum.get(symbol)); } 전략 열거 타입 패턴 enum 인스턴스별로 ‘전략’을 선택하도록 하는 것 열거 타입 상수 일부가 같은 동작을 공유할 때 유용하다. // 코드 34-9 전략 열거 타입 패턴 (218-219쪽) enum PayrollDay { MONDAY(WEEKDAY), TUESDAY(WEEKDAY), WEDNESDAY(WEEKDAY), THURSDAY(WEEKDAY), FRIDAY(WEEKDAY), SATURDAY(WEEKEND), SUNDAY(WEEKEND); private final PayType payType; PayrollDay(PayType payType) { this.payType = payType; } int pay(int minutesWorked, int payRate) { return payType.pay(minutesWorked, payRate); } // 전략 열거 타입 enum PayType { WEEKDAY { int overtimePay(int minsWorked, int payRate) { return minsWorked \u003c= MINS_PER_SHIFT ? 0 : (minsWorked - MINS_PER_SHIFT) * payRate / 2; } }, WEEKEND { int overtimePay(int minsWorked, int payRate) { return minsWorked * payRate / 2; } }; abstract int overtimePay(int mins, int payRate); private static final int MINS_PER_SHIFT = 8 * 60; int pay(int minsWorked, int payRate) { int basePay = minsWorked * payRate; return basePay + overtimePay(minsWorked, payRate); } } public static void main(String[] args) { for (PayrollDay day : values()) System.out.printf(\"%-10s%d%n\", day, day.pay(8 * 60, 1)); } } 필요한 원소를 컴파일타임에 다 알 수 있는 상수 집합이라면 항상 Enum을 사용하자. Enum의 상수 개수가 고정불변일 필요는 없다. 나중에 상수가 추가되어도 바이너리 수준에서 호환되도록 설계되었기 때문 아이템 35: ordinal 메서드 대신 인스턴스 필드를 사용하라 Enum 상수에 연결된 값은 Enum.ordinal() 메서드를 사용해서 얻으면 안 된다. 상수 순서가 바뀔 경우 기존 코드가 깨지고, 중간에 값을 비워둘 수도 없다. (DB에 저장할 때도 순서를 그대로 저장하면 안 된다.) public enum Ensemble{ SOLO, DUET, TRIO, QUARTET, ..., OCTET; public int numberOfMusicians(){ return ordinal() + 1; } } public enum Ensemble{ SOLO(1), DUET(2), TRIO(3), QUARTET(4); private final int numberOfMusicians; Ensemble(int size) { this.numberOfMusicians = size; } public int numberOfMusicians(){ return numberOfMusicians; } } 아이템 36: 비트 필드 대신 EnumSet을 사용하라 열거 상수가 집합으로 사용할 경우, 예전에는 비트 필드 enum 패턴을 사용했다.\npublic class Text { public static final int STYLE_BOLD = 1 \u003c\u003c 0; // 1 public static final int STYLE_ITALIC = 1 \u003c\u003c 1; // 2 public static final int STYLE_UNDERLINE = 1 \u003c\u003c 2; // 4 public static final int STYLE_STRIKETHROUGH = 1 \u003c\u003c 3; // 8 // 매개변수 styles는 0개 이상의 STYLE_ 상수를 비트별 OR한 값이다. public void applyStyles(int styles) {...} } text.applyStyles(STYLE_BOLD | STYLE_ITALIC); String으로 출력하거나 디버거에서 의미를 직관적으로 인식하기 어렵다. 최대 몇 비트가 필요한지 예측해야 한다. → EnumSet을 사용하자.\n내부 구현은 비트 필드와 유사한 형태로 구현되어 있어 효율성과 안전성 모두 만족한다. public class Text { public enum Style { BOLD, ITALIC, UNDERLINE, STRIKETHROUGH } public void applyStyles(Set\u003cStyle\u003e styles) {...} } text.applyStyles(EnumSet.of(Style.BOLD, Style.ITALIC)); 아이템 37: ordinal 인덱싱 대신 EnumMap을 사용하라 Enum.ordinal() 메서드를 배열 인덱스로 사용하면 위험하다.\nSet\u003cPlant\u003e[] plantByLifeCycle = (Set\u003cPlant\u003e[]) new Set[Plant.LifeCycle.values().length]; for (int i = 0; i \u003c plantsByLifeCycle.length; i++) { plantsByLifeCycle[i] = new HashSet\u003c\u003e(); } for (plant p : garden) { plantsByLifeCycle[p.lifeCycle.ordinal()].add(p); } // 결과 출력 for (int i = 0; i \u003c plantsByLifeCycle.length; i++) { System.out.printf(\"%s: %s%n\", Plant.LifeCycle.values()[i], plantsByLifeCycle[i]); } 비검사 형변환을 수행한다. 배열을 직접 사용했기 때문에 각 인덱스의 의미를 설명하는 레이블을 직접 달아야 한다. 정확한 정수값을 사용한다는 것을 직접 보증해야 한다. ordinal()은 상수 선언 순서에 따라 반환값이 바뀐다. → EnumMap을 사용하자.\nEnumMap 열거 타입을 키로 사용하도록 설계된 아주 빠른 Map 구현체\nMap\u003cPlant.LifeCycle, Set\u003cPlant\u003e\u003e plantsByLifeCycle = new EnumMap\u003c\u003e(Plant.LifeCycle.class); for (Plant.LifeCycle lc : Plant.LifeCycle.values()) { plantsByLifeCycle.put(lc, new HashSet\u003c\u003e()); } for (Plant p : garden) { plantsByLifeCycle.get(p.lifeCycle).add(p); } System.out.println(plantsByLifeCycle); 내부 구현 방식을 숨겨 배열 사용 시의 성능과 Map의 타입 안정성을 모두 만족한다. 맵의 키인 열거 타입이 그 자체로 출력용 문자열을 제공한다. 스트림을 사용해 맵을 관리하면 코드를 더 줄일 수 있다.\n//HashMap을 이용한 데이터와 열거타입 매핑 Arrays.stream(garden) .collect(groupingBy(p -\u003e p.lifeCycle)) //EnumMap을 이용해 데이터와 열거타입 매핑 Arrays.stream(garden) .collect(groupingBy( p -\u003e p.lifeCycle, () -\u003e new EnumMap\u003c\u003e(LifeCycle.class), toSet()) ); 다차원 관계는 중첩된 EnumMap으로 표현할 수 있다.\n// 코드 37-5 배열들의 배열의 인덱스에 ordinal()을 사용 - 따라 하지 말 것! public enum Phase { SOLID, LIQUID, GAS; public enum Transition { MELT, FREEZE, BOIL, CONDENSE, SUBLIME, DEPOSIT; // 행은 from의 ordinal을, 열은 to의 ordinal을 인덱스로 쓴다. private static final Transition[][] TRANSITIONS = { { null, MELT, SUBLIME }, { FREEZE, null, BOIL }, { DEPOSIT, CONDENSE, null } }; // 한 상태에서 다른 상태로의 전이를 반환한다. public static Transition from(Phase from, Phase to) { return TRANSITIONS[from.ordinal()][to.ordinal()]; } } } // 코드 37-6 중첩 EnumMap으로 데이터와 열거 타입 쌍을 연결했다. public enum Phase { SOLID, LIQUID, GAS; public enum Transition { MELT(SOLID, LIQUID), FREEBZ(LIQUID, SOLID), BOIL(LIQUID, GAS), CONDENSE(GAS, LIQUID), SUBLIME(SOLID, GAS), DEPOSIT(GAS, SOLID); private final Phase from; private final Phase to; Transition(Phase from, Phase to) { this.from = from; this.to = to; } // 상전이 맵을 초기화한다. private static final Map\u003cPhase, Map\u003cPhase, Transition\u003e\u003e m = Stream.of(values()).collect(groupingBy(t -\u003e t.from, () -\u003e new EnumMap\u003c\u003e(Phase.class), toMap(t -\u003e t.to, t -\u003e t, (x, y) -\u003e y, () -\u003e new EnumMap\u003c\u003e(Phase.class)))); public static Transition from(Phase from, Phase to) { return m.get(from).get(to); } } } 아이템 38: 확장할 수 있는 열거 타입이 필요하면 인터페이스를 사용하라 Enum을 확장하는 것은 일반적으로 좋지 않은 생각이지만, 필요할 경우 인터페이스를 이용할 수 있다.\n기존 Enum을 인터페이스를 구현하도록 만든 뒤, 확장할 Enum은 해당 인터페이스를 구현한 새로운 Enum으로 구성 사용 시에는 인터페이스를 참조한다. public interface Operation { double apply(double x, double y); } public enum BasicOperation implements Operation { PLUS(\"+\") { public double apply(double x, double y) { return x + y; } }, MINUS(\"-\") { public double apply(double x, double y) { return x - y; } }, TIMES(\"*\") { public double apply(double x, double y) { return x * y; } }, DIVIDE(\"/\") { public double apply(double x, double y) { return x / y; } }; private final String symbol; } public enum ExtendedOperation implements Operation { EXP(\"^\") { public double apply(double x, double y) { return Math.pow(x, y); } }, REMAINDER(\"%\") { public double apply(double x, double y) { return x % y; } }; private final String symbol; } public static void main(String[] args) { double x = Double.parseDouble(args[0]); double y = Double.parseDouble(args[1]); test(ExtendedOperation.class, x, y); } private static \u003cT extends Enum\u003cT\u003e \u0026 Operation\u003e void test(Class\u003cT\u003e opEnumType, double x, double y) { for (Operation op : opEnumType.getEnumConstants()) { System.out.printf(\"%f %s %f = %f%n\", x, op, y, op.apply(x, y)); } } Enum은 final이므로 구현을 상속할 수 없기 때문에, 코드 중복이 많아지는 경우 헬퍼 클래스로 분리하는 것이 좋다.\n아이템 39: 명명패턴보다 애너테이션을 사용하라 도구나 프레임워크가 특별히 다루어야 할 프로그램 요소에는 전통적으로 구분되는 명명 패턴을 사용\ne.g. JUnit 3: 모든 테스트 메서드는 test로 시작해야 한다.\n오타에 취약하다. 올바른 프로그램 요소에서만 사용될 보장이 없다. 프로그램 요소를 매개변수로 전달할 마땅한 방법이 없다. → 애너테이션을 사용하자.\n// 코드 39-1 마커(marker) 애너테이션 타입 선언 (238쪽) import java.lang.annotation.*; /** * 테스트 메서드임을 선언하는 애너테이션이다. * 매개변수 없는 정적 메서드 전용이다. */ @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.METHOD) public @interface Test { } // 코드 39-2 마커 애너테이션을 사용한 프로그램 예 (239쪽) public class Sample { @Test public static void m1() { } // 성공해야 한다. public static void m2() { } @Test public static void m3() { // 실패해야 한다. throw new RuntimeException(\"실패\"); } public static void m4() { } // 테스트가 아니다. @Test public void m5() { } // 잘못 사용한 예: 정적 메서드가 아니다. public static void m6() { } @Test public static void m7() { // 실패해야 한다. throw new RuntimeException(\"실패\"); } public static void m8() { } } public class RunTests { public static void main(String[] args) throws Exception { int tests = 0; int passed = 0; Class\u003c?\u003e testClass = Class.forName(args[0]); for (Method m : testClass.getDeclaredMethods()) { if (m.isAnnotationPresent(Test.class)) { tests++; try { m.invoke(null); passed++; } catch (InvocationTargetException wrappedExc) { Throwable exc = wrappedExc.getCause(); System.out.println(m + \" 실패: \" + exc); } catch (Exception exc) { System.out.println(\"잘못 사용한 @Test: \" + m); } } } System.out.printf(\"성공: %d, 실패: %d%n\", passed, tests - passed); } } 애너테이션의 의미 애너테이션은 클래스의 의미에 직접 영향을 주지는 않는다. 애너테이션에 관심 있는 프로그램에 추가 정보를 제공할 뿐이다. 메타 애너테이션 애너테이션 선언에 다는 애너테이션\n@Retention: 애너테이션의 범위를 지정한다. RUNTIME, CLASS, SOURCE @Target: 애너테이션이 적용될 수 있는 위치를 제한한다. PACKAGE, TYPE, CONSTRUCTOR, FIELD, METHOD, ANNOTATION_TYPE, LOCAL_VARIABLE, PARAMETER, TYPE_PARAMETER, TYPE_USE @Inherited: 자식 클래스가 부모 클래스에 달린 애너테이션을 가지도록 한다. @Repeatable: 반복해서 동일한 애너테이션을 달 수 있다. (후술) 매개변수를 받는 애너테이션 /** * 명시한 예외를 던져야만 성공하는 테스트 메서드용 애너테이션 */ @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.METHOD) public @interface ExceptionTest { Class\u003c? extends Throwable\u003e value(); } // 코드 39-5 매개변수 하나짜리 애너테이션을 사용한 프로그램 (241쪽) public class Sample2 { @ExceptionTest(ArithmeticException.class) public static void m1() { // 성공해야 한다. int i = 0; i = i / i; } @ExceptionTest(ArithmeticException.class) public static void m2() { // 실패해야 한다. (다른 예외 발생) int[] a = new int[0]; int i = a[1]; } @ExceptionTest(ArithmeticException.class) public static void m3() { } // 실패해야 한다. (예외가 발생하지 않음) } // 마커 애너테이션과 매개변수 하나짜리 애너태이션을 처리하는 프로그램 (241-242쪽) public class RunTests { public static void main(String[] args) throws Exception { int tests = 0; int passed = 0; Class\u003c?\u003e testClass = Class.forName(args[0]); for (Method m : testClass.getDeclaredMethods()) { if (m.isAnnotationPresent(Test.class)) { tests++; try { m.invoke(null); passed++; } catch (InvocationTargetException wrappedExc) { Throwable exc = wrappedExc.getCause(); System.out.println(m + \" 실패: \" + exc); } catch (Exception exc) { System.out.println(\"잘못 사용한 @Test: \" + m); } } if (m.isAnnotationPresent(ExceptionTest.class)) { tests++; try { m.invoke(null); System.out.printf(\"테스트 %s 실패: 예외를 던지지 않음%n\", m); } catch (InvocationTargetException wrappedEx) { Throwable exc = wrappedEx.getCause(); Class\u003c? extends Throwable\u003e excType = m.getAnnotation(ExceptionTest.class).value(); if (excType.isInstance(exc)) { passed++; } else { System.out.printf( \"테스트 %s 실패: 기대한 예외 %s, 발생한 예외 %s%n\", m, excType.getName(), exc); } } catch (Exception exc) { System.out.println(\"잘못 사용한 @ExceptionTest: \" + m); } } } System.out.printf(\"성공: %d, 실패: %d%n\", passed, tests - passed); } } 배열 매개변수 애너테이션 매개변수를 배열로 받거나, @Repeatable 메타 애너테이션을 사용해 여러 개의 파라미터를 받을 수 있다. 배열로 선언된 매개변수에 하나만 전달하는 경우에는 중괄호로 묶어줄 필요가 없다. 반복 가능 애너테이션 자바 8부터 도입된 @Repeatable 메타 애너테이션을 적용하면 같은 애너테이션을 여러 번 적용할 수 있다.\n@Repeatable을 단 애너테이션을 반환하는 컨테이너 애너테이션을 하나 더 정의하고, 컨테이너 애너테이션의 class 객체를 매개변수로 전달해야 한다. @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.METHOD) @Repeatable(ExceptionTestContainer.class) public @interface ExceptionTest { Class\u003c? extends Throwable\u003e value(); } @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.METHOD) public @interface ExceptionTestContainer { ExceptionTest[] value(); } 컨테이너 애너테이션 타입에는 적절한 보존 정책과 적용 대상 (@Retention, @Target)을 명시해야 한다.\n반복 가능 애너테이션을 하나만 달았을 때와 여러 번 달았을 때는 다른 애너테이션 타입이 적용된다.\n메서드별로 동작이 달라지기 때문에 주의해야 한다. getAnnotationByType은 구분하지 않지만, isAnnotationPresent 메서드는 구분한다. public class RunTests { public static void main(String[] args) throws Exception { int tests = 0; int passed = 0; Class testClass = Class.forName(args[0]); for (Method m : testClass.getDeclaredMethods()) { if (m.isAnnotationPresent(Test.class)) { tests++; try { m.invoke(null); passed++; } catch (InvocationTargetException wrappedExc) { Throwable exc = wrappedExc.getCause(); System.out.println(m + \" 실패: \" + exc); } catch (Exception exc) { System.out.println(\"잘못 사용한 @Test: \" + m); } } // 코드 39-10 반복 가능 애너테이션 다루기 (244-245쪽) if (m.isAnnotationPresent(ExceptionTest.class) || m.isAnnotationPresent(ExceptionTestContainer.class)) { tests++; try { m.invoke(null); System.out.printf(\"테스트 %s 실패: 예외를 던지지 않음%n\", m); } catch (Throwable wrappedExc) { Throwable exc = wrappedExc.getCause(); int oldPassed = passed; ExceptionTest[] excTests = m.getAnnotationsByType(ExceptionTest.class); for (ExceptionTest excTest : excTests) { if (excTest.value().isInstance(exc)) { passed++; break; } } if (passed == oldPassed) System.out.printf(\"테스트 %s 실패: %s %n\", m, exc); } } } System.out.printf(\"성공: %d, 실패: %d%n\", passed, tests - passed); } 애너테이션으로 할 수 있는 일을 명명 패턴으로 처리할 이유는 없다.\n아이템 40: @Override 애너테이션을 일관되게 사용하라 상위 타입의 메서드를 재정의했음을 뜻하는 @Override 메서드를 일관되게 사용하면 많은 버그를 예방할 수 있다.\n// 코드 40-1 영어 알파벳 2개로 구성된 문자열(바이그램)을 표현하는 클래스 - 버그를 찾아보자. (246쪽) public class Bigram { private final char first; private final char second; public Bigram(char first, char second) { this.first = first; this.second = second; } public boolean equals(Bigram b) { return b.first == first \u0026\u0026 b.second == second; } public int hashCode() { return 31 * first + second; } public static void main(String[] args) { Set\u003cBigram\u003e s = new HashSet\u003c\u003e(); for (int i = 0; i \u003c 10; i++) for (char ch = 'a'; ch \u003c= 'z'; ch++) s.add(new Bigram(ch, ch)); System.out.println(s.size()); } } equals() 메서드의 파라미터 타입을 Object로 선언하지 않아 메서드 재정의가 아니라 다중정의가 되어 예상하지 않은 방식으로 작동한다. → 상위 클래스의 메서드를 재정의하고자 하는 모든 곳에 @Override 애너테이션을 붙이면 컴파일 타임에 실수를 예방할 수 있다.\n아이템 41: 정의하려는 것이 타입이라면 마커 인터페이스를 사용하라 마커 인터페이스와 마커 애너테이션은 각자의 쓰임이 있다.\n마커 인터페이스의 장점 마커 인터페이스는 구현한 클래스의 인스턴스를 구분하는 타입으로 쓸 수 있으나, 애너테이션은 그렇지 않다. 적용 대상을 좀 더 정밀하게 지정할 수 있다. 마커 애너테이션의 장점 애너테이션 프레임워크의 지원을 받을 수 있다. → 마킹이 된 객체를 매개변수로 받는 메서드를 작성할 일이 있다면 인터페이스로, 그렇지 않다면 애너테이션으로 작성하자.\n","wordCount":"2311","inLanguage":"en","datePublished":"2021-04-15T00:00:00Z","dateModified":"2021-04-15T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://junbread.win/posts/2021/effective-java-06/"},"publisher":{"@type":"Organization","name":"Junbread🥐","logo":{"@type":"ImageObject","url":"https://junbread.win/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://junbread.win accesskey=h title="Junbread🥐 (Alt + H)">Junbread🥐</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://junbread.win/about title=About><span>About</span></a></li><li><a href=https://junbread.win/archives/ title=아카이브><span>아카이브</span></a></li><li><a href=https://junbread.win/tags/ title=태그><span>태그</span></a></li><li><a href=https://junbread.win/search/ title="검색 (Alt + /)" accesskey=/><span>검색</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://junbread.win>Home</a>&nbsp;»&nbsp;<a href=https://junbread.win/posts/>Posts</a></div><h1 class=post-title>이펙티브 자바 6장 정리</h1><div class=post-meta><span title='2021-04-15 00:00:00 +0000 UTC'>April 15, 2021</span>&nbsp;·&nbsp;11 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-34-int-%ec%83%81%ec%88%98-%eb%8c%80%ec%8b%a0-%ec%97%b4%ea%b1%b0-%ed%83%80%ec%9e%85%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 34: int 상수 대신 열거 타입을 사용하라">아이템 34: int 상수 대신 열거 타입을 사용하라</a><ul><li><a href=#enum-%ed%83%80%ec%9e%85%ec%9d%98-%ec%9e%a5%ec%a0%90 aria-label="Enum 타입의 장점">Enum 타입의 장점</a></li><li><a href=#%ec%83%81%ec%88%98%eb%b3%84-%eb%a9%94%ec%84%9c%eb%93%9c-%ea%b5%ac%ed%98%84 aria-label="상수별 메서드 구현">상수별 메서드 구현</a></li><li><a href=#%ec%a0%84%eb%9e%b5-%ec%97%b4%ea%b1%b0-%ed%83%80%ec%9e%85-%ed%8c%a8%ed%84%b4 aria-label="전략 열거 타입 패턴">전략 열거 타입 패턴</a></li></ul></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-35-ordinal-%eb%a9%94%ec%84%9c%eb%93%9c-%eb%8c%80%ec%8b%a0-%ec%9d%b8%ec%8a%a4%ed%84%b4%ec%8a%a4-%ed%95%84%eb%93%9c%eb%a5%bc-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 35: ordinal 메서드 대신 인스턴스 필드를 사용하라">아이템 35: ordinal 메서드 대신 인스턴스 필드를 사용하라</a></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-36-%eb%b9%84%ed%8a%b8-%ed%95%84%eb%93%9c-%eb%8c%80%ec%8b%a0-enumset%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 36: 비트 필드 대신 EnumSet을 사용하라">아이템 36: 비트 필드 대신 EnumSet을 사용하라</a></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-37-ordinal-%ec%9d%b8%eb%8d%b1%ec%8b%b1-%eb%8c%80%ec%8b%a0-enummap%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 37: ordinal 인덱싱 대신 EnumMap을 사용하라">아이템 37: ordinal 인덱싱 대신 EnumMap을 사용하라</a><ul><li><a href=#enummap aria-label=EnumMap><strong>EnumMap</strong></a></li></ul></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-38-%ed%99%95%ec%9e%a5%ed%95%a0-%ec%88%98-%ec%9e%88%eb%8a%94-%ec%97%b4%ea%b1%b0-%ed%83%80%ec%9e%85%ec%9d%b4-%ed%95%84%ec%9a%94%ed%95%98%eb%a9%b4-%ec%9d%b8%ed%84%b0%ed%8e%98%ec%9d%b4%ec%8a%a4%eb%a5%bc-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 38: 확장할 수 있는 열거 타입이 필요하면 인터페이스를 사용하라">아이템 38: 확장할 수 있는 열거 타입이 필요하면 인터페이스를 사용하라</a></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-39-%eb%aa%85%eb%aa%85%ed%8c%a8%ed%84%b4%eb%b3%b4%eb%8b%a4-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 39: 명명패턴보다 애너테이션을 사용하라">아이템 39: 명명패턴보다 애너테이션을 사용하라</a><ul><li><a href=#%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98%ec%9d%98-%ec%9d%98%eb%af%b8 aria-label="애너테이션의 의미">애너테이션의 의미</a></li><li><a href=#%eb%a9%94%ed%83%80-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98 aria-label="메타 애너테이션">메타 애너테이션</a></li><li><a href=#%eb%a7%a4%ea%b0%9c%eb%b3%80%ec%88%98%eb%a5%bc-%eb%b0%9b%eb%8a%94-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98 aria-label="매개변수를 받는 애너테이션">매개변수를 받는 애너테이션</a></li><li><a href=#%eb%b0%b0%ec%97%b4-%eb%a7%a4%ea%b0%9c%eb%b3%80%ec%88%98-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98 aria-label="배열 매개변수 애너테이션">배열 매개변수 애너테이션</a></li><li><a href=#%eb%b0%98%eb%b3%b5-%ea%b0%80%eb%8a%a5-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98 aria-label="반복 가능 애너테이션">반복 가능 애너테이션</a></li></ul></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-40-override-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98%ec%9d%84-%ec%9d%bc%ea%b4%80%eb%90%98%ea%b2%8c-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 40: @Override 애너테이션을 일관되게 사용하라">아이템 40: @Override 애너테이션을 일관되게 사용하라</a></li><li><a href=#%ec%95%84%ec%9d%b4%ed%85%9c-41-%ec%a0%95%ec%9d%98%ed%95%98%eb%a0%a4%eb%8a%94-%ea%b2%83%ec%9d%b4-%ed%83%80%ec%9e%85%ec%9d%b4%eb%9d%bc%eb%a9%b4-%eb%a7%88%ec%bb%a4-%ec%9d%b8%ed%84%b0%ed%8e%98%ec%9d%b4%ec%8a%a4%eb%a5%bc-%ec%82%ac%ec%9a%a9%ed%95%98%eb%9d%bc aria-label="아이템 41: 정의하려는 것이 타입이라면 마커 인터페이스를 사용하라">아이템 41: 정의하려는 것이 타입이라면 마커 인터페이스를 사용하라</a><ul><li><a href=#%eb%a7%88%ec%bb%a4-%ec%9d%b8%ed%84%b0%ed%8e%98%ec%9d%b4%ec%8a%a4%ec%9d%98-%ec%9e%a5%ec%a0%90 aria-label="마커 인터페이스의 장점">마커 인터페이스의 장점</a></li><li><a href=#%eb%a7%88%ec%bb%a4-%ec%95%a0%eb%84%88%ed%85%8c%ec%9d%b4%ec%85%98%ec%9d%98-%ec%9e%a5%ec%a0%90 aria-label="마커 애너테이션의 장점">마커 애너테이션의 장점</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=아이템-34-int-상수-대신-열거-타입을-사용하라>아이템 34: int 상수 대신 열거 타입을 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-34-int-상수-대신-열거-타입을-사용하라>#</a></h2><p>Java 1.5 Enum 등장 전 사용되던 int enum 패턴</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> APPLE_FUJI <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> APPLE_PIPPIN <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> APPLE_GRANNY_SMITH <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> ORANGE_NAVEL <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> ORANGE_TEMPLE <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> ORANGE_BLOOD <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>;</span>
</span></span></code></pre></div><ul><li>타입 안전을 보장할 방법이 없다.</li><li>표현 방식이 까다롭다.<ul><li>toString(), 디버거 등에서는 그냥 아무 의미 없는 상수로 보인다.</li></ul></li><li>그렇다고 문자열 상수를 사용하자니, 성능 저하 + 문자열 하드코딩의 위험이 있다.</li></ul><p>→ Enum 타입을 사용하자.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Apple <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    FUJI<span style=color:#f92672>,</span> PIPPIN<span style=color:#f92672>,</span> GRANNY_SMITH
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Orange <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    NAVEL<span style=color:#f92672>,</span> TEMPLE<span style=color:#f92672>,</span> BLOOD
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=enum-타입의-장점>Enum 타입의 장점<a hidden class=anchor aria-hidden=true href=#enum-타입의-장점>#</a></h3><ul><li>Java의 Enum은 완전한 클래스이다.</li><li>밖에서 접근 가능한 생성자가 없기 때문에, 사실상 final이다.<ul><li>따라서 오직 하나만 존재함이 보장된다.</li></ul></li><li>컴파일타임 타입 안전성을 제공한다.</li><li>출력하기에 적합한 문자열을 제공한다.</li></ul><h3 id=상수별-메서드-구현>상수별 메서드 구현<a hidden class=anchor aria-hidden=true href=#상수별-메서드-구현>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 코드 34-6 상수별 클래스 몸체(class body)와 데이터를 사용한 열거 타입 (215-216쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Operation <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    PLUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;+&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>+</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    MINUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;-&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>-</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    TIMES<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;*&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>*</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    DIVIDE<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>/</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String symbol<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Operation<span style=color:#f92672>(</span>String symbol<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>symbol</span> <span style=color:#f92672>=</span> symbol<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>toString</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> symbol<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 코드 34-7 열거 타입용 fromString 메서드 구현하기 (216쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> Operation<span style=color:#f92672>&gt;</span> stringToEnum <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>            Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>values<span style=color:#f92672>()).</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                    toMap<span style=color:#f92672>(</span>Object<span style=color:#f92672>::</span>toString<span style=color:#f92672>,</span> e <span style=color:#f92672>-&gt;</span> e<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 지정한 문자열에 해당하는 Operation을 (존재한다면) 반환한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Optional<span style=color:#f92672>&lt;</span>Operation<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>fromString</span><span style=color:#f92672>(</span>String symbol<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>ofNullable</span><span style=color:#f92672>(</span>stringToEnum<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>symbol<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=전략-열거-타입-패턴>전략 열거 타입 패턴<a hidden class=anchor aria-hidden=true href=#전략-열거-타입-패턴>#</a></h3><ul><li>enum 인스턴스별로 &lsquo;전략&rsquo;을 선택하도록 하는 것</li><li>열거 타입 상수 일부가 같은 동작을 공유할 때 유용하다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 코드 34-9 전략 열거 타입 패턴 (218-219쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> PayrollDay <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    MONDAY<span style=color:#f92672>(</span>WEEKDAY<span style=color:#f92672>),</span> TUESDAY<span style=color:#f92672>(</span>WEEKDAY<span style=color:#f92672>),</span> WEDNESDAY<span style=color:#f92672>(</span>WEEKDAY<span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>    THURSDAY<span style=color:#f92672>(</span>WEEKDAY<span style=color:#f92672>),</span> FRIDAY<span style=color:#f92672>(</span>WEEKDAY<span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>    SATURDAY<span style=color:#f92672>(</span>WEEKEND<span style=color:#f92672>),</span> SUNDAY<span style=color:#f92672>(</span>WEEKEND<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> PayType payType<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    PayrollDay<span style=color:#f92672>(</span>PayType payType<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>payType</span> <span style=color:#f92672>=</span> payType<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>pay</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> minutesWorked<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> payRate<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> payType<span style=color:#f92672>.</span><span style=color:#a6e22e>pay</span><span style=color:#f92672>(</span>minutesWorked<span style=color:#f92672>,</span> payRate<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 전략 열거 타입
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>enum</span> PayType <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        WEEKDAY <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>overtimePay</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> minsWorked<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> payRate<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> minsWorked <span style=color:#f92672>&lt;=</span> MINS_PER_SHIFT <span style=color:#f92672>?</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>(</span>minsWorked <span style=color:#f92672>-</span> MINS_PER_SHIFT<span style=color:#f92672>)</span> <span style=color:#f92672>*</span> payRate <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>        WEEKEND <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>overtimePay</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> minsWorked<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> payRate<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> minsWorked <span style=color:#f92672>*</span> payRate <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>overtimePay</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> mins<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> payRate<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> MINS_PER_SHIFT <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>pay</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> minsWorked<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> payRate<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> basePay <span style=color:#f92672>=</span> minsWorked <span style=color:#f92672>*</span> payRate<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> basePay <span style=color:#f92672>+</span> overtimePay<span style=color:#f92672>(</span>minsWorked<span style=color:#f92672>,</span> payRate<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>PayrollDay day <span style=color:#f92672>:</span> values<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%-10s%d%n&#34;</span><span style=color:#f92672>,</span> day<span style=color:#f92672>,</span> day<span style=color:#f92672>.</span><span style=color:#a6e22e>pay</span><span style=color:#f92672>(</span><span style=color:#ae81ff>8</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li>필요한 원소를 컴파일타임에 다 알 수 있는 상수 집합이라면 항상 Enum을 사용하자.</li><li>Enum의 상수 개수가 고정불변일 필요는 없다.<ul><li>나중에 상수가 추가되어도 바이너리 수준에서 호환되도록 설계되었기 때문</li></ul></li></ul><h2 id=아이템-35-ordinal-메서드-대신-인스턴스-필드를-사용하라>아이템 35: ordinal 메서드 대신 인스턴스 필드를 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-35-ordinal-메서드-대신-인스턴스-필드를-사용하라>#</a></h2><ul><li>Enum 상수에 연결된 값은 Enum.ordinal() 메서드를 사용해서 얻으면 안 된다.<ul><li>상수 순서가 바뀔 경우 기존 코드가 깨지고, 중간에 값을 비워둘 수도 없다.</li><li>(DB에 저장할 때도 순서를 그대로 저장하면 안 된다.)</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Ensemble<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	SOLO<span style=color:#f92672>,</span> DUET<span style=color:#f92672>,</span> TRIO<span style=color:#f92672>,</span> QUARTET<span style=color:#f92672>,</span> <span style=color:#f92672>...,</span> OCTET<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>numberOfMusicians</span><span style=color:#f92672>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> ordinal<span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Ensemble<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	SOLO<span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>),</span> DUET<span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>),</span> TRIO<span style=color:#f92672>(</span><span style=color:#ae81ff>3</span><span style=color:#f92672>),</span> QUARTET<span style=color:#f92672>(</span><span style=color:#ae81ff>4</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> numberOfMusicians<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	Ensemble<span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> size<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>numberOfMusicians</span> <span style=color:#f92672>=</span> size<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>numberOfMusicians</span><span style=color:#f92672>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> numberOfMusicians<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=아이템-36-비트-필드-대신-enumset을-사용하라>아이템 36: 비트 필드 대신 EnumSet을 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-36-비트-필드-대신-enumset을-사용하라>#</a></h2><p>열거 상수가 집합으로 사용할 경우, 예전에는 비트 필드 enum 패턴을 사용했다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Text</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> STYLE_BOLD          <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> STYLE_ITALIC        <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span> <span style=color:#75715e>// 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> STYLE_UNDERLINE     <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>;</span> <span style=color:#75715e>// 4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> STYLE_STRIKETHROUGH <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>;</span> <span style=color:#75715e>// 8
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 매개변수 styles는 0개 이상의 STYLE_ 상수를 비트별 OR한 값이다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>applyStyles</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> styles<span style=color:#f92672>)</span> <span style=color:#f92672>{...}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span><span style=color:#a6e22e>applyStyles</span><span style=color:#f92672>(</span>STYLE_BOLD <span style=color:#f92672>|</span> STYLE_ITALIC<span style=color:#f92672>);</span>
</span></span></code></pre></div><ul><li>String으로 출력하거나 디버거에서 의미를 직관적으로 인식하기 어렵다.</li><li>최대 몇 비트가 필요한지 예측해야 한다.</li></ul><p>→ EnumSet을 사용하자.</p><ul><li>내부 구현은 비트 필드와 유사한 형태로 구현되어 있어 효율성과 안전성 모두 만족한다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Text</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Style <span style=color:#f92672>{</span> BOLD<span style=color:#f92672>,</span> ITALIC<span style=color:#f92672>,</span> UNDERLINE<span style=color:#f92672>,</span> STRIKETHROUGH <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>applyStyles</span><span style=color:#f92672>(</span>Set<span style=color:#f92672>&lt;</span>Style<span style=color:#f92672>&gt;</span> styles<span style=color:#f92672>)</span> <span style=color:#f92672>{...}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>text<span style=color:#f92672>.</span><span style=color:#a6e22e>applyStyles</span><span style=color:#f92672>(</span>EnumSet<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>Style<span style=color:#f92672>.</span><span style=color:#a6e22e>BOLD</span><span style=color:#f92672>,</span> Style<span style=color:#f92672>.</span><span style=color:#a6e22e>ITALIC</span><span style=color:#f92672>));</span>
</span></span></code></pre></div><h2 id=아이템-37-ordinal-인덱싱-대신-enummap을-사용하라>아이템 37: ordinal 인덱싱 대신 EnumMap을 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-37-ordinal-인덱싱-대신-enummap을-사용하라>#</a></h2><p>Enum.ordinal() 메서드를 배열 인덱스로 사용하면 위험하다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Set<span style=color:#f92672>&lt;</span>Plant<span style=color:#f92672>&gt;[]</span> plantByLifeCycle <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>Set<span style=color:#f92672>&lt;</span>Plant<span style=color:#f92672>&gt;[])</span> <span style=color:#66d9ef>new</span> Set<span style=color:#f92672>[</span>Plant<span style=color:#f92672>.</span><span style=color:#a6e22e>LifeCycle</span><span style=color:#f92672>.</span><span style=color:#a6e22e>values</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> plantsByLifeCycle<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    plantsByLifeCycle<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>plant p <span style=color:#f92672>:</span> garden<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    plantsByLifeCycle<span style=color:#f92672>[</span>p<span style=color:#f92672>.</span><span style=color:#a6e22e>lifeCycle</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ordinal</span><span style=color:#f92672>()].</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>p<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 결과 출력
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> plantsByLifeCycle<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%s: %s%n&#34;</span><span style=color:#f92672>,</span> Plant<span style=color:#f92672>.</span><span style=color:#a6e22e>LifeCycle</span><span style=color:#f92672>.</span><span style=color:#a6e22e>values</span><span style=color:#f92672>()[</span>i<span style=color:#f92672>],</span> plantsByLifeCycle<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li>비검사 형변환을 수행한다.</li><li>배열을 직접 사용했기 때문에 각 인덱스의 의미를 설명하는 레이블을 직접 달아야 한다.</li><li>정확한 정수값을 사용한다는 것을 직접 보증해야 한다.<ul><li>ordinal()은 상수 선언 순서에 따라 반환값이 바뀐다.</li></ul></li></ul><p>→ EnumMap을 사용하자.</p><h3 id=enummap><strong>EnumMap</strong><a hidden class=anchor aria-hidden=true href=#enummap>#</a></h3><p>열거 타입을 키로 사용하도록 설계된 아주 빠른 Map 구현체</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Map<span style=color:#f92672>&lt;</span>Plant<span style=color:#f92672>.</span><span style=color:#a6e22e>LifeCycle</span><span style=color:#f92672>,</span> Set<span style=color:#f92672>&lt;</span>Plant<span style=color:#f92672>&gt;&gt;</span> plantsByLifeCycle <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> EnumMap<span style=color:#f92672>&lt;&gt;(</span>Plant<span style=color:#f92672>.</span><span style=color:#a6e22e>LifeCycle</span><span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Plant<span style=color:#f92672>.</span><span style=color:#a6e22e>LifeCycle</span> lc <span style=color:#f92672>:</span> Plant<span style=color:#f92672>.</span><span style=color:#a6e22e>LifeCycle</span><span style=color:#f92672>.</span><span style=color:#a6e22e>values</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    plantsByLifeCycle<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span>lc<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;());</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Plant p <span style=color:#f92672>:</span> garden<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    plantsByLifeCycle<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>p<span style=color:#f92672>.</span><span style=color:#a6e22e>lifeCycle</span><span style=color:#f92672>).</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>p<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>plantsByLifeCycle<span style=color:#f92672>);</span>
</span></span></code></pre></div><ul><li>내부 구현 방식을 숨겨 배열 사용 시의 성능과 Map의 타입 안정성을 모두 만족한다.</li><li>맵의 키인 열거 타입이 그 자체로 출력용 문자열을 제공한다.</li></ul><p>스트림을 사용해 맵을 관리하면 코드를 더 줄일 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>//HashMap을 이용한 데이터와 열거타입 매핑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>(</span>garden<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>groupingBy<span style=color:#f92672>(</span>p <span style=color:#f92672>-&gt;</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>lifeCycle</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//EnumMap을 이용해 데이터와 열거타입 매핑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>(</span>garden<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>groupingBy<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        p <span style=color:#f92672>-&gt;</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>lifeCycle</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> EnumMap<span style=color:#f92672>&lt;&gt;(</span>LifeCycle<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>),</span> toSet<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>);</span>
</span></span></code></pre></div><p>다차원 관계는 중첩된 EnumMap으로 표현할 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 코드 37-5 배열들의 배열의 인덱스에 ordinal()을 사용 - 따라 하지 말 것!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Phase <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    SOLID<span style=color:#f92672>,</span> LIQUID<span style=color:#f92672>,</span> GAS<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Transition <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	MELT<span style=color:#f92672>,</span> FREEZE<span style=color:#f92672>,</span> BOIL<span style=color:#f92672>,</span> CONDENSE<span style=color:#f92672>,</span> SUBLIME<span style=color:#f92672>,</span> DEPOSIT<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 행은 from의 ordinal을, 열은 to의 ordinal을 인덱스로 쓴다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Transition<span style=color:#f92672>[][]</span> TRANSITIONS <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	    <span style=color:#f92672>{</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>,</span> MELT<span style=color:#f92672>,</span> SUBLIME <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>	    <span style=color:#f92672>{</span> FREEZE<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>,</span> BOIL <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>	    <span style=color:#f92672>{</span> DEPOSIT<span style=color:#f92672>,</span> CONDENSE<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 한 상태에서 다른 상태로의 전이를 반환한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Transition <span style=color:#a6e22e>from</span><span style=color:#f92672>(</span>Phase from<span style=color:#f92672>,</span> Phase to<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	    <span style=color:#66d9ef>return</span> TRANSITIONS<span style=color:#f92672>[</span>from<span style=color:#f92672>.</span><span style=color:#a6e22e>ordinal</span><span style=color:#f92672>()][</span>to<span style=color:#f92672>.</span><span style=color:#a6e22e>ordinal</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 코드 37-6 중첩 EnumMap으로 데이터와 열거 타입 쌍을 연결했다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Phase <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    SOLID<span style=color:#f92672>,</span> LIQUID<span style=color:#f92672>,</span> GAS<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Transition <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	MELT<span style=color:#f92672>(</span>SOLID<span style=color:#f92672>,</span> LIQUID<span style=color:#f92672>),</span> FREEBZ<span style=color:#f92672>(</span>LIQUID<span style=color:#f92672>,</span> SOLID<span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>	BOIL<span style=color:#f92672>(</span>LIQUID<span style=color:#f92672>,</span> GAS<span style=color:#f92672>),</span> CONDENSE<span style=color:#f92672>(</span>GAS<span style=color:#f92672>,</span> LIQUID<span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>	SUBLIME<span style=color:#f92672>(</span>SOLID<span style=color:#f92672>,</span> GAS<span style=color:#f92672>),</span> DEPOSIT<span style=color:#f92672>(</span>GAS<span style=color:#f92672>,</span> SOLID<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Phase from<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Phase to<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Transition<span style=color:#f92672>(</span>Phase from<span style=color:#f92672>,</span> Phase to<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	    <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>from</span> <span style=color:#f92672>=</span> from<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	    <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>to</span> <span style=color:#f92672>=</span> to<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 상전이 맵을 초기화한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Map<span style=color:#f92672>&lt;</span>Phase<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>Phase<span style=color:#f92672>,</span> Transition<span style=color:#f92672>&gt;&gt;</span>
</span></span><span style=display:flex><span>	  m <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>values<span style=color:#f92672>()).</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>groupingBy<span style=color:#f92672>(</span>t <span style=color:#f92672>-&gt;</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>from</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>	    <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> EnumMap<span style=color:#f92672>&lt;&gt;(</span>Phase<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>            toMap<span style=color:#f92672>(</span>t <span style=color:#f92672>-&gt;</span> t<span style=color:#f92672>.</span><span style=color:#a6e22e>to</span><span style=color:#f92672>,</span> t <span style=color:#f92672>-&gt;</span> t<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> y<span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> EnumMap<span style=color:#f92672>&lt;&gt;(</span>Phase<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>))));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Transition <span style=color:#a6e22e>from</span><span style=color:#f92672>(</span>Phase from<span style=color:#f92672>,</span> Phase to<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	    <span style=color:#66d9ef>return</span> m<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>from<span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>to<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=아이템-38-확장할-수-있는-열거-타입이-필요하면-인터페이스를-사용하라>아이템 38: 확장할 수 있는 열거 타입이 필요하면 인터페이스를 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-38-확장할-수-있는-열거-타입이-필요하면-인터페이스를-사용하라>#</a></h2><p>Enum을 확장하는 것은 일반적으로 좋지 않은 생각이지만, 필요할 경우 인터페이스를 이용할 수 있다.</p><ul><li>기존 Enum을 인터페이스를 구현하도록 만든 뒤, 확장할 Enum은 해당 인터페이스를 구현한 새로운 Enum으로 구성</li><li>사용 시에는 인터페이스를 참조한다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Operation</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> BasicOperation <span style=color:#66d9ef>implements</span> Operation <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    PLUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;+&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>+</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    MINUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;-&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>-</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    TIMES<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;*&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>*</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    DIVIDE<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> x <span style=color:#f92672>/</span> y<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String symbol<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> ExtendedOperation <span style=color:#66d9ef>implements</span> Operation <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    EXP<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;^&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>pow</span><span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>    REMAINDER<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> x <span style=color:#f92672>%</span> y<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String symbol<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> x <span style=color:#f92672>=</span> Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>args<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> y <span style=color:#f92672>=</span> Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>args<span style=color:#f92672>[</span><span style=color:#ae81ff>1</span><span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>    test<span style=color:#f92672>(</span>ExtendedOperation<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>,</span> x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#f92672>&lt;</span>T <span style=color:#66d9ef>extends</span> Enum<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>&amp;</span> Operation<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test</span><span style=color:#f92672>(</span>Class<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> opEnumType<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Operation op <span style=color:#f92672>:</span> opEnumType<span style=color:#f92672>.</span><span style=color:#a6e22e>getEnumConstants</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;%f %s %f = %f%n&#34;</span><span style=color:#f92672>,</span> x<span style=color:#f92672>,</span> op<span style=color:#f92672>,</span> y<span style=color:#f92672>,</span> op<span style=color:#f92672>.</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Enum은 final이므로 구현을 상속할 수 없기 때문에, 코드 중복이 많아지는 경우 헬퍼 클래스로 분리하는 것이 좋다.</p><h2 id=아이템-39-명명패턴보다-애너테이션을-사용하라>아이템 39: 명명패턴보다 애너테이션을 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-39-명명패턴보다-애너테이션을-사용하라>#</a></h2><p>도구나 프레임워크가 특별히 다루어야 할 프로그램 요소에는 전통적으로 구분되는 명명 패턴을 사용</p><p>e.g. JUnit 3: 모든 테스트 메서드는 test로 시작해야 한다.</p><ul><li>오타에 취약하다.</li><li>올바른 프로그램 요소에서만 사용될 보장이 없다.</li><li>프로그램 요소를 매개변수로 전달할 마땅한 방법이 없다.</li></ul><p>→ 애너테이션을 사용하자.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 코드 39-1 마커(marker) 애너테이션 타입 선언 (238쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>import</span> java.lang.annotation.*<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 테스트 메서드임을 선언하는 애너테이션이다.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 매개변수 없는 정적 메서드 전용이다.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Retention</span><span style=color:#f92672>(</span>RetentionPolicy<span style=color:#f92672>.</span><span style=color:#a6e22e>RUNTIME</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Target</span><span style=color:#f92672>(</span>ElementType<span style=color:#f92672>.</span><span style=color:#a6e22e>METHOD</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>@interface</span> Test <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 코드 39-2 마커 애너테이션을 사용한 프로그램 예 (239쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Sample</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m1</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>        <span style=color:#75715e>// 성공해야 한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m2</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m3</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>    <span style=color:#75715e>// 실패해야 한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;실패&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m4</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>  <span style=color:#75715e>// 테스트가 아니다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>@Test</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m5</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>   <span style=color:#75715e>// 잘못 사용한 예: 정적 메서드가 아니다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m6</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m7</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>    <span style=color:#75715e>// 실패해야 한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;실패&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m8</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RunTests</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> Exception <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> tests <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> passed <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Class<span style=color:#f92672>&lt;?&gt;</span> testClass <span style=color:#f92672>=</span> Class<span style=color:#f92672>.</span><span style=color:#a6e22e>forName</span><span style=color:#f92672>(</span>args<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Method m <span style=color:#f92672>:</span> testClass<span style=color:#f92672>.</span><span style=color:#a6e22e>getDeclaredMethods</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>isAnnotationPresent</span><span style=color:#f92672>(</span>Test<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                tests<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    m<span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    passed<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>InvocationTargetException wrappedExc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    Throwable exc <span style=color:#f92672>=</span> wrappedExc<span style=color:#f92672>.</span><span style=color:#a6e22e>getCause</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>m <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; 실패: &#34;</span> <span style=color:#f92672>+</span> exc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception exc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;잘못 사용한 @Test: &#34;</span> <span style=color:#f92672>+</span> m<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;성공: %d, 실패: %d%n&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                passed<span style=color:#f92672>,</span> tests <span style=color:#f92672>-</span> passed<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=애너테이션의-의미>애너테이션의 의미<a hidden class=anchor aria-hidden=true href=#애너테이션의-의미>#</a></h3><ul><li>애너테이션은 클래스의 의미에 직접 영향을 주지는 않는다.</li><li>애너테이션에 관심 있는 프로그램에 추가 정보를 제공할 뿐이다.</li></ul><h3 id=메타-애너테이션>메타 애너테이션<a hidden class=anchor aria-hidden=true href=#메타-애너테이션>#</a></h3><p>애너테이션 선언에 다는 애너테이션</p><ul><li>@Retention: 애너테이션의 범위를 지정한다.<ul><li>RUNTIME, CLASS, SOURCE</li></ul></li><li>@Target: 애너테이션이 적용될 수 있는 위치를 제한한다.<ul><li>PACKAGE, TYPE, CONSTRUCTOR, FIELD, METHOD, ANNOTATION_TYPE, LOCAL_VARIABLE, PARAMETER, TYPE_PARAMETER, TYPE_USE</li></ul></li><li>@Inherited: 자식 클래스가 부모 클래스에 달린 애너테이션을 가지도록 한다.</li><li>@Repeatable: 반복해서 동일한 애너테이션을 달 수 있다. (후술)</li></ul><h3 id=매개변수를-받는-애너테이션>매개변수를 받는 애너테이션<a hidden class=anchor aria-hidden=true href=#매개변수를-받는-애너테이션>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 명시한 예외를 던져야만 성공하는 테스트 메서드용 애너테이션
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Retention</span><span style=color:#f92672>(</span>RetentionPolicy<span style=color:#f92672>.</span><span style=color:#a6e22e>RUNTIME</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Target</span><span style=color:#f92672>(</span>ElementType<span style=color:#f92672>.</span><span style=color:#a6e22e>METHOD</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>@interface</span> ExceptionTest <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Class<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> Throwable<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 코드 39-5 매개변수 하나짜리 애너테이션을 사용한 프로그램 (241쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Sample2</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ExceptionTest</span><span style=color:#f92672>(</span>ArithmeticException<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m1</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>  <span style=color:#75715e>// 성공해야 한다.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        i <span style=color:#f92672>=</span> i <span style=color:#f92672>/</span> i<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ExceptionTest</span><span style=color:#f92672>(</span>ArithmeticException<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m2</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>  <span style=color:#75715e>// 실패해야 한다. (다른 예외 발생)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> a<span style=color:#f92672>[</span><span style=color:#ae81ff>1</span><span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ExceptionTest</span><span style=color:#f92672>(</span>ArithmeticException<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>m3</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>  <span style=color:#75715e>// 실패해야 한다. (예외가 발생하지 않음)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 마커 애너테이션과 매개변수 하나짜리 애너태이션을 처리하는 프로그램 (241-242쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RunTests</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> Exception <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> tests <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> passed <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Class<span style=color:#f92672>&lt;?&gt;</span> testClass <span style=color:#f92672>=</span> Class<span style=color:#f92672>.</span><span style=color:#a6e22e>forName</span><span style=color:#f92672>(</span>args<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Method m <span style=color:#f92672>:</span> testClass<span style=color:#f92672>.</span><span style=color:#a6e22e>getDeclaredMethods</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>isAnnotationPresent</span><span style=color:#f92672>(</span>Test<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                tests<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    m<span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    passed<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>InvocationTargetException wrappedExc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    Throwable exc <span style=color:#f92672>=</span> wrappedExc<span style=color:#f92672>.</span><span style=color:#a6e22e>getCause</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>m <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; 실패: &#34;</span> <span style=color:#f92672>+</span> exc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception exc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;잘못 사용한 @Test: &#34;</span> <span style=color:#f92672>+</span> m<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>isAnnotationPresent</span><span style=color:#f92672>(</span>ExceptionTest<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                tests<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    m<span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;테스트 %s 실패: 예외를 던지지 않음%n&#34;</span><span style=color:#f92672>,</span> m<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>InvocationTargetException wrappedEx<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    Throwable exc <span style=color:#f92672>=</span> wrappedEx<span style=color:#f92672>.</span><span style=color:#a6e22e>getCause</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                    Class<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> Throwable<span style=color:#f92672>&gt;</span> excType <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>                            m<span style=color:#f92672>.</span><span style=color:#a6e22e>getAnnotation</span><span style=color:#f92672>(</span>ExceptionTest<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>).</span><span style=color:#a6e22e>value</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>excType<span style=color:#f92672>.</span><span style=color:#a6e22e>isInstance</span><span style=color:#f92672>(</span>exc<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        passed<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;테스트 %s 실패: 기대한 예외 %s, 발생한 예외 %s%n&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                m<span style=color:#f92672>,</span> excType<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> exc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception exc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;잘못 사용한 @ExceptionTest: &#34;</span> <span style=color:#f92672>+</span> m<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;성공: %d, 실패: %d%n&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                passed<span style=color:#f92672>,</span> tests <span style=color:#f92672>-</span> passed<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=배열-매개변수-애너테이션>배열 매개변수 애너테이션<a hidden class=anchor aria-hidden=true href=#배열-매개변수-애너테이션>#</a></h3><ul><li>매개변수를 배열로 받거나, @Repeatable 메타 애너테이션을 사용해 여러 개의 파라미터를 받을 수 있다.<ul><li>배열로 선언된 매개변수에 하나만 전달하는 경우에는 중괄호로 묶어줄 필요가 없다.</li></ul></li></ul><h3 id=반복-가능-애너테이션>반복 가능 애너테이션<a hidden class=anchor aria-hidden=true href=#반복-가능-애너테이션>#</a></h3><p>자바 8부터 도입된 @Repeatable 메타 애너테이션을 적용하면 같은 애너테이션을 여러 번 적용할 수 있다.</p><ul><li>@Repeatable을 단 애너테이션을 반환하는 컨테이너 애너테이션을 하나 더 정의하고, 컨테이너 애너테이션의 class 객체를 매개변수로 전달해야 한다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Retention</span><span style=color:#f92672>(</span>RetentionPolicy<span style=color:#f92672>.</span><span style=color:#a6e22e>RUNTIME</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Target</span><span style=color:#f92672>(</span>ElementType<span style=color:#f92672>.</span><span style=color:#a6e22e>METHOD</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Repeatable</span><span style=color:#f92672>(</span>ExceptionTestContainer<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>@interface</span> ExceptionTest <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Class<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> Throwable<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Retention</span><span style=color:#f92672>(</span>RetentionPolicy<span style=color:#f92672>.</span><span style=color:#a6e22e>RUNTIME</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Target</span><span style=color:#f92672>(</span>ElementType<span style=color:#f92672>.</span><span style=color:#a6e22e>METHOD</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>@interface</span> ExceptionTestContainer <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    ExceptionTest<span style=color:#f92672>[]</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li><p>컨테이너 애너테이션 타입에는 적절한 보존 정책과 적용 대상 (@Retention, @Target)을 명시해야 한다.</p></li><li><p>반복 가능 애너테이션을 하나만 달았을 때와 여러 번 달았을 때는 다른 애너테이션 타입이 적용된다.</p><ul><li>메서드별로 동작이 달라지기 때문에 주의해야 한다.</li><li>getAnnotationByType은 구분하지 않지만, isAnnotationPresent 메서드는 구분한다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RunTests</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> Exception <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> tests <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> passed <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Class testClass <span style=color:#f92672>=</span> Class<span style=color:#f92672>.</span><span style=color:#a6e22e>forName</span><span style=color:#f92672>(</span>args<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Method m <span style=color:#f92672>:</span> testClass<span style=color:#f92672>.</span><span style=color:#a6e22e>getDeclaredMethods</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>isAnnotationPresent</span><span style=color:#f92672>(</span>Test<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                tests<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    m<span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    passed<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>InvocationTargetException wrappedExc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    Throwable exc <span style=color:#f92672>=</span> wrappedExc<span style=color:#f92672>.</span><span style=color:#a6e22e>getCause</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>m <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; 실패: &#34;</span> <span style=color:#f92672>+</span> exc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception exc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;잘못 사용한 @Test: &#34;</span> <span style=color:#f92672>+</span> m<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 코드 39-10 반복 가능 애너테이션 다루기 (244-245쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>isAnnotationPresent</span><span style=color:#f92672>(</span>ExceptionTest<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>||</span> m<span style=color:#f92672>.</span><span style=color:#a6e22e>isAnnotationPresent</span><span style=color:#f92672>(</span>ExceptionTestContainer<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                tests<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    m<span style=color:#f92672>.</span><span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;테스트 %s 실패: 예외를 던지지 않음%n&#34;</span><span style=color:#f92672>,</span> m<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Throwable wrappedExc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    Throwable exc <span style=color:#f92672>=</span> wrappedExc<span style=color:#f92672>.</span><span style=color:#a6e22e>getCause</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>int</span> oldPassed <span style=color:#f92672>=</span> passed<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                    ExceptionTest<span style=color:#f92672>[]</span> excTests <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>                            m<span style=color:#f92672>.</span><span style=color:#a6e22e>getAnnotationsByType</span><span style=color:#f92672>(</span>ExceptionTest<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>ExceptionTest excTest <span style=color:#f92672>:</span> excTests<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>excTest<span style=color:#f92672>.</span><span style=color:#a6e22e>value</span><span style=color:#f92672>().</span><span style=color:#a6e22e>isInstance</span><span style=color:#f92672>(</span>exc<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                            passed<span style=color:#f92672>++;</span>
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>passed <span style=color:#f92672>==</span> oldPassed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;테스트 %s 실패: %s %n&#34;</span><span style=color:#f92672>,</span> m<span style=color:#f92672>,</span> exc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;성공: %d, 실패: %d%n&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                          passed<span style=color:#f92672>,</span> tests <span style=color:#f92672>-</span> passed<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span></code></pre></div></li></ul><blockquote><p>애너테이션으로 할 수 있는 일을 명명 패턴으로 처리할 이유는 없다.</p></blockquote><h2 id=아이템-40-override-애너테이션을-일관되게-사용하라>아이템 40: @Override 애너테이션을 일관되게 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-40-override-애너테이션을-일관되게-사용하라>#</a></h2><p>상위 타입의 메서드를 재정의했음을 뜻하는 @Override 메서드를 일관되게 사용하면 많은 버그를 예방할 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 코드 40-1 영어 알파벳 2개로 구성된 문자열(바이그램)을 표현하는 클래스 - 버그를 찾아보자. (246쪽)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Bigram</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>char</span> first<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>char</span> second<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Bigram</span><span style=color:#f92672>(</span><span style=color:#66d9ef>char</span> first<span style=color:#f92672>,</span> <span style=color:#66d9ef>char</span> second<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>first</span>  <span style=color:#f92672>=</span> first<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>second</span> <span style=color:#f92672>=</span> second<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Bigram b<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> b<span style=color:#f92672>.</span><span style=color:#a6e22e>first</span> <span style=color:#f92672>==</span> first <span style=color:#f92672>&amp;&amp;</span> b<span style=color:#f92672>.</span><span style=color:#a6e22e>second</span> <span style=color:#f92672>==</span> second<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>hashCode</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>31</span> <span style=color:#f92672>*</span> first <span style=color:#f92672>+</span> second<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Bigram<span style=color:#f92672>&gt;</span> s <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>char</span> ch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>;</span> ch <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;z&#39;</span><span style=color:#f92672>;</span> ch<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                s<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> Bigram<span style=color:#f92672>(</span>ch<span style=color:#f92672>,</span> ch<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li>equals() 메서드의 파라미터 타입을 Object로 선언하지 않아 메서드 재정의가 아니라 다중정의가 되어 예상하지 않은 방식으로 작동한다.</li></ul><p>→ 상위 클래스의 메서드를 재정의하고자 하는 모든 곳에 @Override 애너테이션을 붙이면 컴파일 타임에 실수를 예방할 수 있다.</p><h2 id=아이템-41-정의하려는-것이-타입이라면-마커-인터페이스를-사용하라>아이템 41: 정의하려는 것이 타입이라면 마커 인터페이스를 사용하라<a hidden class=anchor aria-hidden=true href=#아이템-41-정의하려는-것이-타입이라면-마커-인터페이스를-사용하라>#</a></h2><p>마커 인터페이스와 마커 애너테이션은 각자의 쓰임이 있다.</p><h3 id=마커-인터페이스의-장점>마커 인터페이스의 장점<a hidden class=anchor aria-hidden=true href=#마커-인터페이스의-장점>#</a></h3><ul><li>마커 인터페이스는 구현한 클래스의 인스턴스를 구분하는 타입으로 쓸 수 있으나, 애너테이션은 그렇지 않다.</li><li>적용 대상을 좀 더 정밀하게 지정할 수 있다.</li></ul><h3 id=마커-애너테이션의-장점>마커 애너테이션의 장점<a hidden class=anchor aria-hidden=true href=#마커-애너테이션의-장점>#</a></h3><ul><li>애너테이션 프레임워크의 지원을 받을 수 있다.</li></ul><p>→ 마킹이 된 객체를 매개변수로 받는 메서드를 작성할 일이 있다면 인터페이스로, 그렇지 않다면 애너테이션으로 작성하자.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://junbread.win/tags/study/>Study</a></li><li><a href=https://junbread.win/tags/java/>Java</a></li></ul><nav class=paginav><a class=prev href=https://junbread.win/posts/2021/effective-java-07/><span class=title>« Prev</span><br><span>이펙티브 자바 7장 정리</span></a>
<a class=next href=https://junbread.win/posts/2021/effective-java-05/><span class=title>Next »</span><br><span>이펙티브 자바 5장 정리</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=junbread/blog data-repo-id=R_kgDOJLcBtQ data-category=Comments data-category-id=DIC_kwDOJLcBtc4CVATm data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=dark data-lang=ko data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://junbread.win>Junbread🥐</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>